-- phpMyAdmin SQL Dump
-- version 5.2.2-1.fc42
-- https://www.phpmyadmin.net/
--
-- Host: localhost
-- Creato il: Set 24, 2025 alle 14:09
-- Versione del server: 10.11.11-MariaDB
-- Versione PHP: 8.4.12

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `eu_projectmanager`
--

DELIMITER $$
--
-- Procedure
--
CREATE DEFINER=`parseccoop`@`%` PROCEDURE `UpdateRiskScore` (IN `p_project_risk_id` INT, IN `p_new_probability` INT, IN `p_new_impact` INT, IN `p_change_reason` VARCHAR(255))   BEGIN
    DECLARE v_old_score INT;
    DECLARE v_new_score INT;
    DECLARE v_new_status ENUM('Low', 'Medium', 'High', 'Critical');
    
    DECLARE exit handler for sqlexception
    BEGIN
        ROLLBACK;
        RESIGNAL;
    END;
    
    START TRANSACTION;
    
    SELECT `current_score` INTO v_old_score
    FROM `project_risks`
    WHERE `id` = p_project_risk_id
    FOR UPDATE;
    
    SET v_new_score = p_new_probability * p_new_impact;
    
    CASE
        WHEN v_new_score > 12 THEN SET v_new_status = 'Critical';
        WHEN v_new_score > 6 THEN SET v_new_status = 'High';
        WHEN v_new_score > 2 THEN SET v_new_status = 'Medium';
        ELSE SET v_new_status = 'Low';
    END CASE;
    
    UPDATE `project_risks`
    SET
        `current_probability` = p_new_probability,
        `current_impact` = p_new_impact,
        `current_score` = v_new_score,
        `status` = v_new_status
    WHERE `id` = p_project_risk_id;
    
    IF v_old_score <> v_new_score THEN
        INSERT INTO `risk_history` (`project_risk_id`, `old_score`, `new_score`, `change_reason`)
        VALUES (p_project_risk_id, v_old_score, v_new_score, p_change_reason);
    END IF;
    
    COMMIT;
END$$

DELIMITER ;

-- --------------------------------------------------------

--
-- Struttura della tabella `activities`
--

CREATE TABLE `activities` (
  `id` int(11) NOT NULL,
  `work_package_id` int(11) NOT NULL,
  `activity_number` varchar(20) DEFAULT NULL,
  `name` varchar(200) NOT NULL,
  `description` text DEFAULT NULL,
  `responsible_partner_id` int(11) DEFAULT NULL,
  `start_date` date DEFAULT NULL,
  `end_date` date DEFAULT NULL,
  `due_date` date DEFAULT NULL,
  `status` enum('not_started','in_progress','completed','overdue') DEFAULT 'not_started',
  `progress` decimal(5,2) DEFAULT 0.00,
  `created_at` timestamp NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `project_id` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `activities`
--

INSERT INTO `activities` (`id`, `work_package_id`, `activity_number`, `name`, `description`, `responsible_partner_id`, `start_date`, `end_date`, `due_date`, `status`, `progress`, `created_at`, `updated_at`, `project_id`) VALUES
(35, 12, '1.1', 'First Setup and Governance', 'Online kick-off meeting organization. Distribution partnership agreements to all partners. Defining roles, responsibilities and operating procedures. Build integrated communication system (WhatsApp, Email, Google Drive). Setup e-learning platform for material exchanges.', 1, '2025-08-01', '2025-10-01', '2025-10-01', 'in_progress', 50.00, '2025-08-07 04:37:41', '2025-08-30 08:44:04', 28),
(37, 12, '1.2', 'Online Kick off meeting', 'KOM online', 1, '2025-09-24', '2025-09-30', '2025-09-15', 'in_progress', 0.00, '2025-08-27 13:30:15', '2025-09-16 16:08:02', 28),
(41, 14, '2.1', 'Desk Research: Comparative analysis of reception and integration systems for migrant minors and professionals involved', 'This activity maps reception and integration models across partner countries, focusing on youth work, intercultural mediation, and education pathways. Key activities include comparing national policies and identifying strengths, gaps, and best practices.', 8, '2025-09-01', '2025-10-31', '2025-10-31', 'not_started', 0.00, '2025-08-27 15:04:15', '2025-08-27 15:04:15', 28),
(42, 14, '2.2', 'Field Research: Training needs assessment', 'This phase ensures WP3 training directly addresses youth workers needs and prepares for WP4 peer education. Key activities include surveying/interviewing 50+ youth workers and educators to assess skill gaps and organizing 5 transnational focus groups engaging youth workers and young migrants.', 8, '2025-11-01', '2026-01-31', '2026-01-31', 'not_started', 0.00, '2025-08-27 15:04:15', '2025-08-27 15:04:15', 28),
(43, 14, '2.3', 'Development of Training Modules Framework', 'WP2 findings will shape structured, practice-oriented training for WP3, ensuring youth workers are equipped to facilitate WP4 peer education. Key activities include organizing co-creation workshops where youth workers and young migrants refine training content.', 8, '2026-02-01', '2026-03-31', '2026-03-31', 'not_started', 0.00, '2025-08-27 15:04:15', '2025-08-27 15:04:15', 28),
(46, 15, '3.1', 'Training workshops for operators and mediators', 'A transnational training program that will provide youth workers with key methodologies to support young migrants effectively. This intensive program will introduce empathetic listening, intercultural communication, and peer education strategies. Participants will engage in interactive sessions, scenario analysis, and real-life case studies, ensuring that training is both practical and adaptable across different national contexts.', 1, '2026-06-01', '2026-07-31', '2026-07-31', 'not_started', 0.00, '2025-09-17 19:19:46', '2025-09-17 19:19:46', 28),
(47, 15, '3.2', 'Best practices exchanges and peer training for youth workers', 'To enhance the transferability and impact of the training, WP3 will facilitate structured exchanges between professionals from different partner countries. These sessions will allow participants to share challenges and solutions, showcase at least 10 best practices in working with young migrants, and enable a peer-to-peer learning process, where trained youth workers train their colleagues and refine methods before full-scale implementation.', 1, '2026-07-01', '2026-11-30', '2026-11-30', 'not_started', 0.00, '2025-09-17 19:19:46', '2025-09-17 19:19:46', 28),
(48, 15, '3.3', 'Intermediate Meeting and Bridge model development', 'Building on WP2 research findings and WP3 training outcomes, this phase formalizes the BRIDGE intervention model, integrating: core principles of empathetic listening and peer education to prevent radicalization; structured methodologies for youth workers, ensuring consistency in approaches across partner countries; practical guidelines for implementation; transnational meeting in Spain to finalize the intervention model, allowing partners to visit reception services in Canary Islands.', 2, '2026-11-01', '2027-02-28', '2027-02-28', 'not_started', 0.00, '2025-09-17 19:19:46', '2025-09-17 19:19:46', 28),
(55, 18, '4.1', 'Engaging and listening minor migrant', 'This phase focuses on identifying and engaging young migrants across partner countries to participate in the peer education model. Activities include selecting groups of migrant minors who will participate in the peer education path, establishing trust-building relationships, and conducting initial assessment of their needs and interests. Each partner will identify 20 young peers and draft a comprehensive peer education model.', 9, '2026-06-01', '2026-08-31', '2026-08-31', 'not_started', 0.00, '2025-09-17 19:30:10', '2025-09-17 19:30:10', 28),
(56, 18, '4.2', 'Mixing Culture', 'The co-creation of Mixing Culture engages young migrants in designing a game-based learning tool that translates empathetic listening and storytelling into an interactive educational format. This activity involves activating 5 peer groups in various local contexts, developing the board game through participatory workshops, and implementing pilot sessions to test and refine the educational tool.', 9, '2026-09-01', '2027-03-31', '2027-03-31', 'not_started', 0.00, '2025-09-17 19:30:10', '2025-09-17 19:30:10', 28),
(57, 18, '4.3', 'Peer Education', 'This final phase implements the structured peer education model where trained young migrants support their peers in navigating integration challenges. Activities focus on empowering peer educators to facilitate Mixing Culture sessions, promoting intercultural dialogue, and strengthening leadership skills among young migrants as promoters of tolerance and prevention of radicalization.', 9, '2027-04-01', '2027-07-01', '2027-07-01', 'not_started', 0.00, '2025-09-17 19:30:10', '2025-09-17 19:30:10', 28),
(58, 19, '5.1', 'Strategic Communication Planning and Digital Platform Development', 'This foundational activity establishes the communication framework through developing a comprehensive dissemination strategy, visual identity, and multilingual digital platform. Activities include creating a communication toolkit with templates and guidelines, developing the project website as central hub for resources, and establishing the visual identity and branding guidelines.', 2, '2025-09-01', '2025-11-30', '2025-11-30', 'not_started', 0.00, '2025-09-17 19:30:21', '2025-09-17 19:30:21', 28),
(59, 19, '5.2', 'Project Launch Events', '5 coordinated launch events (1 in each partner country) will introduce the project to local stakeholders. These events present project objectives, facilitate stakeholder discussion on migrant youth integration, establish initial networks, and create visibility through coordinated press releases. Expected to engage at least 150 participants total across all countries.', 1, '2025-10-01', '2025-12-31', '2025-12-31', 'not_started', 0.00, '2025-09-17 19:30:21', '2025-09-17 19:30:21', 28),
(60, 19, '5.3', 'Ongoing Digital Communication and Content Creation', 'AsociaciÃ³n Creativa coordinates regular digital content production including a 5-episode video series documenting migrant experiences, website updates, quarterly newsletters, digital training materials integration, and development of the comprehensive BRIDGE Model Toolkit providing step-by-step guidance for youth workers.', 2, '2025-09-01', '2027-07-31', '2027-07-31', 'not_started', 0.00, '2025-09-17 19:30:21', '2025-09-17 19:30:21', 28),
(61, 19, '5.4', 'Multiplier Events and Stakeholder Engagement', 'Five multiplier events focused on practical demonstrations of project outcomes, with policy briefs development for local and EU decision-makers containing evidence-based recommendations for improving integration policies. Events will engage youth workers, educators, authorities, and migrants to showcase project results and foster networking.', 8, '2027-04-01', '2027-07-01', '2027-07-01', 'not_started', 0.00, '2025-09-17 19:30:21', '2025-09-17 19:30:21', 28),
(62, 19, '5.5', 'Final Conference and Sustainability Planning', 'The concluding activity features a final conference in Rome bringing together partners, key stakeholders, and beneficiaries to present overall results, discuss impact, and explore future implementation. The conference will include workshops, policy discussions, networking opportunities, and presentation of the sustainability plan.', 1, '2027-07-01', '2027-08-31', '2027-08-31', 'not_started', 0.00, '2025-09-17 19:30:21', '2025-09-17 19:30:21', 28);

-- --------------------------------------------------------

--
-- Struttura della tabella `activity_reports`
--

CREATE TABLE `activity_reports` (
  `id` int(11) NOT NULL,
  `activity_id` int(11) NOT NULL,
  `partner_id` int(11) NOT NULL,
  `user_id` int(11) DEFAULT NULL,
  `report_date` date NOT NULL,
  `description` text DEFAULT NULL,
  `participants_data` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `coordinator_feedback` text DEFAULT NULL,
  `reviewed_at` timestamp NULL DEFAULT NULL,
  `reviewed_by` int(11) DEFAULT NULL,
  `project_id` int(11) DEFAULT NULL,
  `risk_collaboration_rating` int(11) DEFAULT NULL,
  `risk_recruitment_difficulty` int(11) DEFAULT NULL,
  `risk_quality_check` int(11) DEFAULT NULL,
  `risk_budget_status` varchar(10) DEFAULT NULL,
  `test_col` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Struttura della tabella `alerts`
--

CREATE TABLE `alerts` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `project_id` int(11) DEFAULT NULL,
  `activity_id` int(11) DEFAULT NULL,
  `type` enum('deadline','report_submitted','milestone','general','risk','risk_persistent') NOT NULL,
  `title` varchar(200) NOT NULL,
  `message` text DEFAULT NULL,
  `is_read` tinyint(1) DEFAULT 0,
  `created_at` timestamp NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `alerts`
--

INSERT INTO `alerts` (`id`, `user_id`, `project_id`, `activity_id`, `type`, `title`, `message`, `is_read`, `created_at`) VALUES
(1, 1, 28, NULL, 'risk_persistent', 'Persistent Risk Alert: Bridge', 'Risk DifficoltÃ  nel reclutamento e nel coinvolgimento del target group (giovani migranti) (Score: 16, Status: Critical) is currently critical. Please review.', 1, '2025-08-29 02:22:22'),
(2, 1, 28, NULL, 'risk_persistent', 'Persistent Risk Alert: Bridge', 'Risk DifficoltÃ  nel reclutamento e nel coinvolgimento del target group (giovani migranti) (Score: 16, Status: Critical) is currently critical. Please review.', 1, '2025-08-29 02:24:14'),
(3, 1, 28, NULL, 'risk_persistent', 'Persistent Risk Alert: Bridge', 'Risk DifficoltÃ  nel reclutamento e nel coinvolgimento del target group (giovani migranti) (Score: 16, Status: Critical) is currently critical. Please review.', 1, '2025-08-29 02:24:23'),
(4, 7, 28, NULL, 'risk_persistent', 'Persistent Risk Alert: Bridge', 'Risk DifficoltÃ  nel reclutamento e nel coinvolgimento del target group (giovani migranti) (Score: 16, Status: Critical) is currently critical. Please review.', 1, '2025-08-29 02:28:02'),
(5, 1, 28, NULL, 'risk_persistent', 'Persistent Risk Alert: Bridge', 'Risk \'DifficoltÃ  nel reclutamento e nel coinvolgimento del target group (giovani migranti)\' (Score: 16, Status: Critical) is currently critical. Please review.', 1, '2025-08-29 06:10:56'),
(6, 7, 28, NULL, 'risk_persistent', 'Persistent Risk Alert: Bridge', 'Risk \'DifficoltÃ  nel reclutamento e nel coinvolgimento del target group (giovani migranti)\' (Score: 16, Status: Critical) is currently critical. Please review.', 1, '2025-08-29 06:18:03'),
(7, 7, 28, NULL, 'risk_persistent', 'Critical Risk: Bridge', 'ðŸš¨ Risk \'QualitÃ  degli output dei Work Package 3-4 non conforme agli standard attesi\' (Score: 16, Status: Critical) requires immediate attention.', 1, '2025-09-24 06:19:40'),
(8, 7, 28, NULL, 'risk_persistent', 'Critical Risk: Bridge', 'ðŸš¨ Risk \'QualitÃ  degli output dei Work Package 3-4 non conforme agli standard attesi\' (Score: 16, Status: Critical) requires immediate attention.', 1, '2025-09-24 06:19:50');

-- --------------------------------------------------------

--
-- Struttura della tabella `budget_travel_subsistence`
--

CREATE TABLE `budget_travel_subsistence` (
  `id` int(11) NOT NULL,
  `wp_partner_budget_id` int(11) NOT NULL COMMENT 'FK to work_package_partner_budgets',
  `activity_destination` varchar(255) NOT NULL COMMENT 'Activity description or destination',
  `persons` int(11) NOT NULL COMMENT 'Number of persons',
  `days` int(11) NOT NULL COMMENT 'Number of days',
  `travel_cost` decimal(10,2) NOT NULL COMMENT 'Travel cost in EUR',
  `daily_subsistence` decimal(10,2) NOT NULL COMMENT 'Daily subsistence rate in EUR',
  `created_at` timestamp NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `total` decimal(10,2) NOT NULL DEFAULT 0.00 COMMENT 'Manual total cost entered by user'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Travel and subsistence costs for work packages (max 3 per WP)';

--
-- Dump dei dati per la tabella `budget_travel_subsistence`
--

INSERT INTO `budget_travel_subsistence` (`id`, `wp_partner_budget_id`, `activity_destination`, `persons`, `days`, `travel_cost`, `daily_subsistence`, `created_at`, `updated_at`, `total`) VALUES
(41, 7, 'Kick Off Germany', 3, 3, 541.00, 216.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 3210.00),
(42, 8, 'Kick off Germany', 3, 3, 245.00, 216.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2322.00),
(43, 6, 'Kick off Germany', 3, 3, 276.00, 216.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2415.00),
(44, 10, 'Kick off Germany', 3, 3, 429.00, 216.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2874.00),
(45, 17, 'Short Training Netherlands', 4, 5, 541.00, 236.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 6352.00),
(46, 18, 'Meeting Spain', 2, 4, 541.00, 205.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2488.00),
(47, 16, 'Short Training Netherlands', 4, 5, 288.00, 236.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 5340.00),
(48, 16, 'Meeting Spain', 2, 4, 541.00, 205.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2488.00),
(49, 19, 'Short Training Netherlands', 4, 5, 288.00, 236.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 5340.00),
(50, 19, 'Meeting Spain', 2, 4, 541.00, 205.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2488.00),
(51, 20, 'Short Training Netherlands', 4, 5, 429.00, 236.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 5904.00),
(52, 20, 'Meeting Spain', 2, 4, 659.00, 205.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2724.00),
(53, 22, 'Meeting Greece', 2, 4, 659.00, 189.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2616.00),
(54, 23, 'Meeting Greece', 2, 3, 429.00, 189.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2156.00),
(55, 21, 'Meeting Greece', 2, 4, 276.00, 189.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 1850.00),
(56, 24, 'Meeting Greece', 2, 3, 429.00, 189.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2156.00),
(57, 27, 'Final Meeting Italy', 2, 3, 541.00, 212.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 2126.00),
(58, 28, 'Final Meeting Italy', 2, 3, 288.00, 212.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 1620.00),
(59, 29, 'Final Meeting Italy', 2, 3, 288.00, 212.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 1620.00),
(60, 30, 'Final Meeting Italy', 2, 3, 276.00, 212.00, '2025-09-24 07:11:13', '2025-09-24 07:11:13', 1596.00);

-- --------------------------------------------------------

--
-- Struttura della tabella `milestones`
--

CREATE TABLE `milestones` (
  `id` int(11) NOT NULL,
  `project_id` int(11) NOT NULL,
  `work_package_id` int(11) DEFAULT NULL,
  `name` varchar(200) NOT NULL,
  `description` text DEFAULT NULL,
  `due_date` date NOT NULL,
  `status` enum('pending','completed','overdue') DEFAULT 'pending',
  `completed_date` date DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `milestones`
--

INSERT INTO `milestones` (`id`, `project_id`, `work_package_id`, `name`, `description`, `due_date`, `status`, `completed_date`, `created_at`) VALUES
(12, 28, 12, 'Kick off Meeting online', 'Meeting online di avvio progetto', '2025-09-28', 'pending', NULL, '2025-08-28 17:31:02');

-- --------------------------------------------------------

--
-- Struttura della tabella `participant_categories`
--

CREATE TABLE `participant_categories` (
  `id` int(11) NOT NULL,
  `project_id` int(11) NOT NULL,
  `name` varchar(100) NOT NULL,
  `description` text DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Struttura della tabella `partners`
--

CREATE TABLE `partners` (
  `id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `organization_type` varchar(100) DEFAULT NULL,
  `country` varchar(100) DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dump dei dati per la tabella `partners`
--

INSERT INTO `partners` (`id`, `name`, `organization_type`, `country`, `created_at`) VALUES
(1, 'Cooperativa Parsec', 'NGO', 'Italy', '2025-07-31 08:53:10'),
(2, 'AsociaciÃ³n Creativa', 'NGO', 'Spain', '2025-07-31 08:53:10'),
(3, 'VELA Foundation', 'NGO', 'Greece', '2025-07-31 08:53:10'),
(8, 'Gewerkstatt', 'NGO', 'Germany', '2025-08-04 14:10:24'),
(9, 'Changes&Chances', 'NGO', 'Netherlands', '2025-08-04 14:11:11'),
(10, 'Pippi Peli Uniti', 'University', 'USA', '2025-08-28 13:47:10');

-- --------------------------------------------------------

--
-- Struttura della tabella `projects`
--

CREATE TABLE `projects` (
  `id` int(11) NOT NULL,
  `name` varchar(200) NOT NULL,
  `description` text DEFAULT NULL,
  `program_type` varchar(50) DEFAULT NULL,
  `start_date` date DEFAULT NULL,
  `end_date` date DEFAULT NULL,
  `coordinator_id` int(11) DEFAULT NULL,
  `status` enum('planning','active','suspended','completed') DEFAULT 'planning',
  `budget` decimal(12,2) DEFAULT NULL,
  `google_groups_url` varchar(500) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `projects`
--

INSERT INTO `projects` (`id`, `name`, `description`, `program_type`, `start_date`, `end_date`, `coordinator_id`, `status`, `budget`, `google_groups_url`, `created_at`, `updated_at`) VALUES
(28, 'Bridge', 'Project Bridge prevents youth radicalisation by fostering social inclusion of young migrants and unaccompanied minors. It trains youth workers in empathic listening and intercultural facilitation, while empowering migrants as peer educators. Co-created tools, including the game Mixing Culture, promote dialogue, participation, and sustainable integration.', 'erasmus_plus', '2025-09-01', '2027-08-31', 7, 'active', 250000.00, 'https://groups.google.com/g/erasmus-bridge', '2025-08-04 15:47:02', '2025-09-16 15:18:57');

-- --------------------------------------------------------

--
-- Struttura della tabella `project_partners`
--

CREATE TABLE `project_partners` (
  `id` int(11) NOT NULL,
  `project_id` int(11) NOT NULL,
  `partner_id` int(11) NOT NULL,
  `role` enum('coordinator','partner') DEFAULT 'partner',
  `organization` varchar(100) DEFAULT NULL,
  `country` varchar(50) DEFAULT NULL,
  `budget_allocated` decimal(10,2) DEFAULT NULL,
  `joined_at` timestamp NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `project_partners`
--

INSERT INTO `project_partners` (`id`, `project_id`, `partner_id`, `role`, `organization`, `country`, `budget_allocated`, `joined_at`) VALUES
(52, 28, 1, 'coordinator', NULL, NULL, 60056.00, '2025-08-04 15:47:02'),
(53, 28, 2, 'partner', NULL, NULL, 43894.00, '2025-08-04 15:48:10'),
(54, 28, 8, 'partner', NULL, NULL, 51928.00, '2025-08-04 15:48:10'),
(55, 28, 9, 'partner', NULL, NULL, 50982.00, '2025-08-04 15:48:10'),
(56, 28, 3, 'partner', NULL, NULL, 43140.00, '2025-08-04 15:48:10');

-- --------------------------------------------------------

--
-- Struttura della tabella `project_partners_old`
--

CREATE TABLE `project_partners_old` (
  `id` int(11) NOT NULL,
  `project_id` int(11) NOT NULL,
  `partner_id` int(11) NOT NULL,
  `qqq` int(11) NOT NULL,
  `role` enum('coordinator','partner') DEFAULT 'partner',
  `organization` varchar(100) DEFAULT NULL,
  `country` varchar(50) DEFAULT NULL,
  `budget_allocated` decimal(10,2) DEFAULT NULL,
  `joined_at` timestamp NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Struttura della tabella `project_risks`
--

CREATE TABLE `project_risks` (
  `id` int(11) NOT NULL,
  `project_id` int(11) NOT NULL,
  `risk_id` int(11) NOT NULL,
  `current_probability` int(11) NOT NULL DEFAULT 1,
  `current_impact` int(11) NOT NULL DEFAULT 1,
  `current_score` int(11) NOT NULL DEFAULT 1,
  `status` enum('Low','Medium','High','Critical') NOT NULL DEFAULT 'Low',
  `last_updated` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `project_risks`
--

INSERT INTO `project_risks` (`id`, `project_id`, `risk_id`, `current_probability`, `current_impact`, `current_score`, `status`, `last_updated`) VALUES
(1, 28, 1, 1, 3, 3, 'Medium', '2025-09-23 07:11:23'),
(2, 28, 2, 1, 4, 4, 'Medium', '2025-09-23 07:11:23'),
(3, 28, 3, 2, 3, 6, 'Medium', '2025-09-23 07:11:23'),
(4, 28, 4, 1, 3, 3, 'Medium', '2025-09-23 07:11:23'),
(5, 28, 5, 1, 5, 5, 'Medium', '2025-09-23 07:11:23'),
(6, 28, 6, 2, 2, 4, 'Medium', '2025-09-24 06:20:22'),
(7, 28, 7, 2, 1, 2, 'Low', '2025-09-24 06:20:28'),
(8, 28, 8, 1, 4, 4, 'Medium', '2025-09-23 07:11:23'),
(9, 28, 9, 2, 3, 6, 'Medium', '2025-09-23 07:11:23'),
(10, 28, 10, 2, 3, 6, 'Medium', '2025-09-24 06:20:38');

-- --------------------------------------------------------

--
-- Struttura della tabella `risks`
--

CREATE TABLE `risks` (
  `id` int(11) NOT NULL,
  `risk_code` varchar(10) NOT NULL,
  `category` varchar(100) NOT NULL,
  `description` text NOT NULL,
  `critical_threshold` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `risks`
--

INSERT INTO `risks` (`id`, `risk_code`, `category`, `description`, `critical_threshold`) VALUES
(1, 'BR01', 'Coordinamento', 'Ritardi nel coordinamento e nella gestione dei Work Package 2-4', 12),
(2, 'BR02', 'Target Group', 'DifficoltÃ  nel reclutamento e nel coinvolgimento del target group (giovani migranti)', 12),
(3, 'BR03', 'Tecnico', 'Problemi tecnici sulla piattaforma di progetto (downtime, bug, performance)', 6),
(4, 'BR04', 'Team', 'Conflitti interculturali o problemi di comunicazione all interno del partenariato', 8),
(5, 'BR05', 'Budget', 'Superamento del budget previsto (overrun) o gestione finanziaria inefficiente', 12),
(6, 'BR06', 'QualitÃ ', 'QualitÃ  degli output dei Work Package 3-4 non conforme agli standard attesi', 12),
(7, 'BR07', 'Disseminazione', 'Scarsa efficacia delle attivitÃ  di disseminazione e comunicazione dei risultati', 9),
(8, 'BR08', 'Esterno', 'Impatto di emergenze sanitarie o altre crisi esterne sul progetto', 8),
(9, 'BR09', 'Team', 'Turnover dello staff chiave all interno dei partner di progetto', 9),
(10, 'BR10', 'Normativo', 'Mancata conformitÃ  con le normative (es. GDPR) o con le regole del programma', 10);

-- --------------------------------------------------------

--
-- Struttura della tabella `risk_alerts`
--

CREATE TABLE `risk_alerts` (
  `id` int(11) NOT NULL,
  `project_risk_id` int(11) NOT NULL,
  `alert_level` int(11) NOT NULL,
  `message` text NOT NULL,
  `is_acknowledged` tinyint(1) NOT NULL DEFAULT 0,
  `acknowledged_by_user_id` int(11) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Struttura della tabella `risk_history`
--

CREATE TABLE `risk_history` (
  `id` int(11) NOT NULL,
  `project_risk_id` int(11) NOT NULL,
  `old_score` int(11) DEFAULT NULL,
  `new_score` int(11) NOT NULL,
  `change_reason` varchar(255) DEFAULT NULL,
  `timestamp` timestamp NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `risk_history`
--

INSERT INTO `risk_history` (`id`, `project_risk_id`, `old_score`, `new_score`, `change_reason`, `timestamp`) VALUES
(1, 1, 1, 9, 'Test: Aumento rischio coordinamento da report mensile', '2025-08-27 06:57:49'),
(2, 9, 1, 4, 'Manual update from admin panel.', '2025-08-27 11:28:33'),
(4, 1, 9, 16, 'Manual update from admin panel.', '2025-08-29 02:04:03'),
(5, 1, 16, 4, 'Manual update from admin panel.', '2025-08-29 02:15:51'),
(6, 2, 1, 16, 'Manual update from admin panel.', '2025-08-29 02:15:58'),
(7, 2, 16, 4, 'Manual update from admin panel.', '2025-08-29 06:19:57'),
(8, 2, 4, 1, 'Manual update from admin panel.', '2025-08-29 06:20:31'),
(9, 1, 4, 3, 'Recalculated based on overdue milestones and activities.', '2025-09-23 07:11:23'),
(10, 2, 1, 4, 'Recalculated based on recruitment difficulty.', '2025-09-23 07:11:23'),
(11, 3, 1, 6, 'Recalculated based on simulated technical issues.', '2025-09-23 07:11:23'),
(12, 4, 1, 3, 'Recalculated based on collaboration ratings.', '2025-09-23 07:11:23'),
(13, 5, 1, 5, 'Recalulated based on budget status reports.', '2025-09-23 07:11:23'),
(14, 6, 1, 16, 'Recalculated based on output quality checks.', '2025-09-23 07:11:23'),
(15, 7, 1, 9, 'Recalculated based on simulated dissemination metrics.', '2025-09-23 07:11:23'),
(16, 8, 1, 4, 'Recalculated based on simulated health emergencies.', '2025-09-23 07:11:23'),
(17, 9, 4, 6, 'Recalculated based on simulated staff turnover.', '2025-09-23 07:11:23'),
(18, 10, 1, 9, 'Recalculated based on simulated non-compliance.', '2025-09-23 07:11:23'),
(19, 6, 16, 4, 'Manual update from admin panel.', '2025-09-24 06:20:22'),
(20, 7, 9, 2, 'Manual update from admin panel.', '2025-09-24 06:20:28'),
(21, 10, 9, 6, 'Manual update from admin panel.', '2025-09-24 06:20:38');

-- --------------------------------------------------------

--
-- Struttura della tabella `uploaded_files`
--

CREATE TABLE `uploaded_files` (
  `id` int(11) NOT NULL,
  `project_id` int(11) DEFAULT NULL,
  `report_id` int(11) DEFAULT NULL,
  `filename` varchar(255) NOT NULL,
  `original_filename` varchar(255) NOT NULL,
  `title` varchar(255) DEFAULT NULL,
  `file_path` varchar(500) NOT NULL,
  `file_size` int(11) DEFAULT NULL,
  `file_type` varchar(50) DEFAULT NULL,
  `uploaded_by` int(11) NOT NULL,
  `uploaded_at` timestamp NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `uploaded_files`
--

INSERT INTO `uploaded_files` (`id`, `project_id`, `report_id`, `filename`, `original_filename`, `title`, `file_path`, `file_size`, `file_type`, `uploaded_by`, `uploaded_at`) VALUES
(1, 28, NULL, 'proj_28_68d06ca83ec5a7.66117069.pdf', 'Bridge Approved_compressed.pdf', 'Bridge Approved_compressed.pdf', 'uploads/proj_28_68d06ca83ec5a7.66117069.pdf', 407634, 'application/pdf', 7, '2025-09-21 21:22:48'),
(2, 28, NULL, 'proj_28_68d06d84b8a764.03447667.png', 'Aree di intervento.png', 'Aree di intervento.png', 'uploads/proj_28_68d06d84b8a764.03447667.png', 140278, 'image/png', 7, '2025-09-21 21:26:28');

-- --------------------------------------------------------

--
-- Struttura della tabella `users`
--

CREATE TABLE `users` (
  `id` int(11) NOT NULL,
  `username` varchar(50) NOT NULL,
  `email` varchar(100) NOT NULL,
  `password` varchar(255) NOT NULL,
  `full_name` varchar(100) NOT NULL,
  `role` enum('super_admin','coordinator','partner','admin') NOT NULL,
  `partner_id` int(11) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `is_active` tinyint(1) DEFAULT 1
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `users`
--

INSERT INTO `users` (`id`, `username`, `email`, `password`, `full_name`, `role`, `partner_id`, `created_at`, `updated_at`, `is_active`) VALUES
(1, 'admin', 'admin@cooperativaparsec.it', '$2y$10$gy2bXvzryp/zhVf9dX0Wqe9eBOyXOyJ4M7jcoJPtDE52LezychRAe', 'Super Admin Parsec', 'super_admin', NULL, '2025-07-30 03:18:44', '2025-07-30 03:18:44', 1),
(3, 'partner_spain', 'partner@spain.eu', '$2y$10$LZ7Pv9cdow989LAihIEW5uMwen4a3V1Lvkn7iZYDjsxEqXjShM3Oi', 'Carlos Garcia', 'partner', 2, '2025-07-30 03:18:44', '2025-07-31 08:57:03', 1),
(4, 'partner_greece', 'partner@greece.eu', '$2y$10$LZ7Pv9cdow989LAihIEW5uMwen4a3V1Lvkn7iZYDjsxEqXjShM3Oi', 'Maria Papadopoulos', 'partner', 3, '2025-07-30 03:18:44', '2025-07-31 08:57:03', 1),
(6, 'project@cooperativaparsec.it', 'project@cooperativaparsec.it', '$2y$12$.EJ5tB5wpsGu6rnLw/FpjewiUlZJWsMKzt.vERXcvSR3oZUNN8HEG', 'Carmen Silipo', 'coordinator', 1, '2025-07-31 10:46:26', '2025-07-31 10:46:26', 1),
(7, 'guidoricci.lavoro@gmail.com', 'guidoricci.lavoro@gmail.com', '$2y$12$exB8ORR89GFMa0fX6Tk2pOzyTUCgqmp38hk1M4hz/BRiLbliaDU5u', 'Guido Ricci', 'coordinator', 1, '2025-08-27 07:32:12', '2025-08-27 07:32:12', 1),
(10, 'pippopelo@ggg.it', 'pippopelo@ggg.it', '$2y$10$2G1.WxmBi2Y1nimfCucU/uEHZUxhUe55C1JTdpB.zytDByu1Viy56', 'Pippo Pelo', 'partner', 10, '2025-08-30 08:45:14', '2025-08-30 08:45:14', 1);

-- --------------------------------------------------------

--
-- Struttura della tabella `work_packages`
--

CREATE TABLE `work_packages` (
  `id` int(11) NOT NULL,
  `project_id` int(11) NOT NULL,
  `wp_number` varchar(10) NOT NULL,
  `name` varchar(200) NOT NULL,
  `description` text DEFAULT NULL,
  `lead_partner_id` int(11) DEFAULT NULL,
  `start_date` date DEFAULT NULL,
  `end_date` date DEFAULT NULL,
  `budget` decimal(10,2) DEFAULT NULL,
  `status` enum('not_started','in_progress','completed','delayed') DEFAULT 'not_started',
  `progress` decimal(5,2) DEFAULT 0.00,
  `created_at` timestamp NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `work_packages`
--

INSERT INTO `work_packages` (`id`, `project_id`, `wp_number`, `name`, `description`, `lead_partner_id`, `start_date`, `end_date`, `budget`, `status`, `progress`, `created_at`) VALUES
(12, 28, 'WP1', 'PROJECT MANAGEMENT', 'WP1 ensures the overall coordination of the BRIDGE project through integrated quality, budget, timing and communication between partners. It includes continuous monitoring, risk management and reporting to ensure the achievement of project objectives and compliance with Erasmus+ requirements.', 1, '2025-09-01', '2027-08-31', 32420.99, 'in_progress', 4.00, '2025-08-07 04:32:15'),
(14, 28, 'WP2', 'Knowing the phenomena: Analysis and comparison about young migrants and radicalization', 'WP2 establishes the methodological and operational foundation for BRIDGE, ensuring that the project actions are evidence-based and aligned with concrete needs. The main objective is to create a structured framework that informs training methodologies and participatory educational tools, integrating empathic listening as a guide approach.', 3, '2025-09-01', '2026-03-31', 42854.00, 'not_started', 0.00, '2025-08-27 12:49:57'),
(15, 28, 'WP3', 'Empathic listening to collect stories: Training for Youth operators and team working with Migrants', 'WP3 focuses on training youth workers, fostering best practice exchanges, and developing a shared intervention model. It ensures that professionals working with young migrants are equipped with empathetic listening, intercultural facilitation, and radicalization prevention skills, creating a sustainable framework for social inclusion.', 1, '2026-06-01', '2027-02-28', 75552.00, 'not_started', 0.00, '2025-09-17 18:55:14'),
(18, 28, 'WP4', 'Mixing cultures: Involvement and training of minors migrants trough board games', 'WP4 aims to empower young migrants as active agents of inclusion by implementing a peer education model and developing the Mixing Culture educational tool. This work package shifts youth participation from passive to active, placing them at the center of learning and integration through game-based learning and peer education methodologies.', 9, '2026-06-01', '2027-07-01', 52677.80, 'not_started', 0.00, '2025-09-17 19:26:47'),
(19, 28, 'WP5', 'Dissemination and Exploitation', 'WP5 ensures that project results effectively reach identified target groups and create lasting impact beyond the project duration. The dissemination strategy integrates EU values of inclusion and participation, ensuring that communication activities actively engage stakeholders in the process of social change through digital platforms, events, and strategic communication.', 2, '2025-09-01', '2027-08-31', 46492.76, 'not_started', 0.00, '2025-09-17 19:26:47');

-- --------------------------------------------------------

--
-- Struttura della tabella `work_package_partner_budgets`
--

CREATE TABLE `work_package_partner_budgets` (
  `id` int(11) NOT NULL,
  `work_package_id` int(11) NOT NULL COMMENT 'FK alla tabella work_packages',
  `partner_id` int(11) NOT NULL COMMENT 'FK alla tabella partners',
  `project_id` int(11) NOT NULL COMMENT 'FK alla tabella projects (per integritÃ )',
  `created_at` timestamp NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `wp_type` enum('project_management','standard') DEFAULT 'standard' COMMENT 'Type of work package: project_management for WP1, standard for others',
  `project_management_cost` decimal(10,2) DEFAULT NULL COMMENT 'Flat rate cost for WP1 project management only',
  `working_days` int(11) DEFAULT NULL COMMENT 'Number of working days (for standard WP only)',
  `daily_rate` decimal(10,2) DEFAULT NULL COMMENT 'Daily rate in EUR (for standard WP only)',
  `working_days_total` decimal(10,2) DEFAULT NULL COMMENT 'Calculated: working_days * daily_rate',
  `other_costs` decimal(10,2) DEFAULT 0.00 COMMENT 'Other miscellaneous costs',
  `other_description` text DEFAULT NULL COMMENT 'Description of other costs'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dump dei dati per la tabella `work_package_partner_budgets`
--

INSERT INTO `work_package_partner_budgets` (`id`, `work_package_id`, `partner_id`, `project_id`, `created_at`, `updated_at`, `wp_type`, `project_management_cost`, `working_days`, `daily_rate`, `working_days_total`, `other_costs`, `other_description`) VALUES
(6, 12, 1, 28, '2025-09-17 07:54:52', '2025-09-24 07:11:13', 'project_management', 7199.99, NULL, NULL, NULL, 0.00, ''),
(7, 12, 2, 28, '2025-09-17 07:54:52', '2025-09-24 07:11:13', 'project_management', 3600.00, NULL, NULL, NULL, 0.00, ''),
(8, 12, 9, 28, '2025-09-17 07:54:52', '2025-09-24 07:11:13', 'project_management', 3600.00, NULL, NULL, NULL, 0.00, ''),
(9, 12, 8, 28, '2025-09-17 07:54:52', '2025-09-24 07:11:13', 'project_management', 3600.00, NULL, NULL, NULL, 0.00, ''),
(10, 12, 3, 28, '2025-09-17 07:54:52', '2025-09-24 07:11:13', 'project_management', 3600.00, NULL, NULL, NULL, 0.00, ''),
(16, 15, 1, 28, '2025-09-17 18:56:24', '2025-09-24 07:11:13', 'standard', NULL, 62, 214.00, 13268.00, 0.00, ''),
(17, 15, 2, 28, '2025-09-17 18:56:24', '2025-09-24 07:11:13', 'standard', NULL, 40, 137.00, 5480.00, 0.00, ''),
(18, 15, 9, 28, '2025-09-17 18:56:24', '2025-09-24 07:11:13', 'standard', NULL, 40, 241.00, 9640.00, 0.00, ''),
(19, 15, 8, 28, '2025-09-17 18:56:24', '2025-09-24 07:11:13', 'standard', NULL, 40, 214.00, 8560.00, 0.00, ''),
(20, 15, 3, 28, '2025-09-17 18:56:24', '2025-09-24 07:11:13', 'standard', NULL, 40, 137.00, 5480.00, 0.00, ''),
(21, 18, 1, 28, '2025-09-17 19:28:01', '2025-09-24 07:11:13', 'standard', NULL, 44, 213.98, 9415.12, 0.00, ''),
(22, 18, 2, 28, '2025-09-17 19:28:01', '2025-09-24 07:11:13', 'standard', NULL, 44, 137.00, 6028.00, 0.00, ''),
(23, 18, 9, 28, '2025-09-17 19:28:01', '2025-09-24 07:11:13', 'standard', NULL, 54, 241.00, 13014.00, 0.00, ''),
(24, 18, 8, 28, '2025-09-17 19:28:01', '2025-09-24 07:11:13', 'standard', NULL, 44, 213.97, 9414.68, 0.00, ''),
(25, 18, 3, 28, '2025-09-17 19:28:01', '2025-09-24 07:11:13', 'standard', NULL, 44, 137.00, 6028.00, 0.00, ''),
(26, 19, 1, 28, '2025-09-17 19:28:16', '2025-09-24 07:11:13', 'standard', NULL, 24, 213.99, 5135.76, 4811.00, '1200 multiplier events + website and moodle'),
(27, 19, 2, 28, '2025-09-17 19:28:16', '2025-09-24 07:11:13', 'standard', NULL, 48, 137.00, 6576.00, 2700.00, '1200 multiplier events + 1500 Graphic design'),
(28, 19, 9, 28, '2025-09-17 19:28:16', '2025-09-24 07:11:13', 'standard', NULL, 24, 241.00, 5784.00, 1200.00, 'Multiplier events'),
(29, 19, 8, 28, '2025-09-17 19:28:16', '2025-09-24 07:11:13', 'standard', NULL, 24, 214.00, 5136.00, 1200.00, 'multiplier events'),
(30, 19, 3, 28, '2025-09-17 19:28:16', '2025-09-24 07:11:13', 'standard', NULL, 24, 137.00, 3288.00, 3700.00, '1200 multiplier events + 2500 translations'),
(36, 14, 1, 28, '2025-09-21 21:44:01', '2025-09-24 07:11:13', 'standard', NULL, 38, 214.00, 8132.00, 0.00, ''),
(37, 14, 2, 28, '2025-09-21 21:44:01', '2025-09-24 07:11:13', 'standard', NULL, 38, 137.00, 5206.00, 0.00, ''),
(38, 14, 3, 28, '2025-09-21 21:44:01', '2025-09-24 07:11:13', 'standard', NULL, 58, 137.00, 7946.00, 0.00, ''),
(39, 14, 8, 28, '2025-09-21 21:44:01', '2025-09-24 07:11:13', 'standard', NULL, 58, 214.00, 12412.00, 0.00, ''),
(40, 14, 9, 28, '2025-09-21 21:44:01', '2025-09-24 07:11:13', 'standard', NULL, 38, 241.00, 9158.00, 0.00, '');

--
-- Indici per le tabelle scaricate
--

--
-- Indici per le tabelle `activities`
--
ALTER TABLE `activities`
  ADD PRIMARY KEY (`id`),
  ADD KEY `work_package_id` (`work_package_id`),
  ADD KEY `responsible_partner_id` (`responsible_partner_id`),
  ADD KEY `fk_activity_project` (`project_id`);

--
-- Indici per le tabelle `activity_reports`
--
ALTER TABLE `activity_reports`
  ADD PRIMARY KEY (`id`),
  ADD KEY `activity_id` (`activity_id`),
  ADD KEY `partner_id` (`partner_id`),
  ADD KEY `fk_report_user` (`user_id`),
  ADD KEY `fk_activity_report_project` (`project_id`);

--
-- Indici per le tabelle `alerts`
--
ALTER TABLE `alerts`
  ADD PRIMARY KEY (`id`),
  ADD KEY `user_id` (`user_id`),
  ADD KEY `project_id` (`project_id`),
  ADD KEY `activity_id` (`activity_id`);

--
-- Indici per le tabelle `budget_travel_subsistence`
--
ALTER TABLE `budget_travel_subsistence`
  ADD PRIMARY KEY (`id`),
  ADD KEY `fk_travel_wp_budget` (`wp_partner_budget_id`),
  ADD KEY `idx_travel_activity` (`activity_destination`);

--
-- Indici per le tabelle `milestones`
--
ALTER TABLE `milestones`
  ADD PRIMARY KEY (`id`),
  ADD KEY `project_id` (`project_id`),
  ADD KEY `work_package_id` (`work_package_id`);

--
-- Indici per le tabelle `participant_categories`
--
ALTER TABLE `participant_categories`
  ADD PRIMARY KEY (`id`),
  ADD KEY `project_id` (`project_id`);

--
-- Indici per le tabelle `partners`
--
ALTER TABLE `partners`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `name_unique` (`name`);

--
-- Indici per le tabelle `projects`
--
ALTER TABLE `projects`
  ADD PRIMARY KEY (`id`),
  ADD KEY `coordinator_id` (`coordinator_id`);

--
-- Indici per le tabelle `project_partners`
--
ALTER TABLE `project_partners`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_project_partner` (`project_id`,`partner_id`),
  ADD KEY `fk_project_partner_link` (`partner_id`);

--
-- Indici per le tabelle `project_partners_old`
--
ALTER TABLE `project_partners_old`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_project_user` (`project_id`,`qqq`),
  ADD KEY `fk_project_partner_link` (`partner_id`);

--
-- Indici per le tabelle `project_risks`
--
ALTER TABLE `project_risks`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `project_risk_unique` (`project_id`,`risk_id`),
  ADD KEY `risk_id` (`risk_id`);

--
-- Indici per le tabelle `risks`
--
ALTER TABLE `risks`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `risk_code` (`risk_code`);

--
-- Indici per le tabelle `risk_alerts`
--
ALTER TABLE `risk_alerts`
  ADD PRIMARY KEY (`id`),
  ADD KEY `project_risk_id` (`project_risk_id`);

--
-- Indici per le tabelle `risk_history`
--
ALTER TABLE `risk_history`
  ADD PRIMARY KEY (`id`),
  ADD KEY `project_risk_id` (`project_risk_id`);

--
-- Indici per le tabelle `uploaded_files`
--
ALTER TABLE `uploaded_files`
  ADD PRIMARY KEY (`id`),
  ADD KEY `report_id` (`report_id`),
  ADD KEY `uploaded_by` (`uploaded_by`),
  ADD KEY `fk_uploaded_file_project` (`project_id`);

--
-- Indici per le tabelle `users`
--
ALTER TABLE `users`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `username` (`username`),
  ADD UNIQUE KEY `email` (`email`),
  ADD KEY `fk_user_partner` (`partner_id`);

--
-- Indici per le tabelle `work_packages`
--
ALTER TABLE `work_packages`
  ADD PRIMARY KEY (`id`),
  ADD KEY `project_id` (`project_id`),
  ADD KEY `lead_partner_id` (`lead_partner_id`);

--
-- Indici per le tabelle `work_package_partner_budgets`
--
ALTER TABLE `work_package_partner_budgets`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_wp_partner` (`work_package_id`,`partner_id`),
  ADD KEY `fk_wpbudget_work_package` (`work_package_id`),
  ADD KEY `fk_wpbudget_partner` (`partner_id`),
  ADD KEY `fk_wpbudget_project` (`project_id`),
  ADD KEY `idx_wp_type` (`wp_type`);

--
-- AUTO_INCREMENT per le tabelle scaricate
--

--
-- AUTO_INCREMENT per la tabella `activities`
--
ALTER TABLE `activities`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=63;

--
-- AUTO_INCREMENT per la tabella `activity_reports`
--
ALTER TABLE `activity_reports`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=22;

--
-- AUTO_INCREMENT per la tabella `alerts`
--
ALTER TABLE `alerts`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=9;

--
-- AUTO_INCREMENT per la tabella `budget_travel_subsistence`
--
ALTER TABLE `budget_travel_subsistence`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=61;

--
-- AUTO_INCREMENT per la tabella `milestones`
--
ALTER TABLE `milestones`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=13;

--
-- AUTO_INCREMENT per la tabella `participant_categories`
--
ALTER TABLE `participant_categories`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT per la tabella `partners`
--
ALTER TABLE `partners`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=11;

--
-- AUTO_INCREMENT per la tabella `projects`
--
ALTER TABLE `projects`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=31;

--
-- AUTO_INCREMENT per la tabella `project_partners`
--
ALTER TABLE `project_partners`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=62;

--
-- AUTO_INCREMENT per la tabella `project_partners_old`
--
ALTER TABLE `project_partners_old`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT per la tabella `project_risks`
--
ALTER TABLE `project_risks`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=17;

--
-- AUTO_INCREMENT per la tabella `risks`
--
ALTER TABLE `risks`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=12;

--
-- AUTO_INCREMENT per la tabella `risk_alerts`
--
ALTER TABLE `risk_alerts`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT per la tabella `risk_history`
--
ALTER TABLE `risk_history`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=22;

--
-- AUTO_INCREMENT per la tabella `uploaded_files`
--
ALTER TABLE `uploaded_files`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT per la tabella `users`
--
ALTER TABLE `users`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=11;

--
-- AUTO_INCREMENT per la tabella `work_packages`
--
ALTER TABLE `work_packages`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=20;

--
-- AUTO_INCREMENT per la tabella `work_package_partner_budgets`
--
ALTER TABLE `work_package_partner_budgets`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=181;

--
-- Limiti per le tabelle scaricate
--

--
-- Limiti per la tabella `activities`
--
ALTER TABLE `activities`
  ADD CONSTRAINT `activities_ibfk_1` FOREIGN KEY (`work_package_id`) REFERENCES `work_packages` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `activities_ibfk_2` FOREIGN KEY (`responsible_partner_id`) REFERENCES `partners` (`id`),
  ADD CONSTRAINT `fk_activity_project` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE;

--
-- Limiti per la tabella `activity_reports`
--
ALTER TABLE `activity_reports`
  ADD CONSTRAINT `activity_reports_ibfk_1` FOREIGN KEY (`activity_id`) REFERENCES `activities` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_activity_report_project` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_report_to_partner_organization` FOREIGN KEY (`partner_id`) REFERENCES `partners` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_report_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE SET NULL;

--
-- Limiti per la tabella `alerts`
--
ALTER TABLE `alerts`
  ADD CONSTRAINT `alerts_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `alerts_ibfk_2` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `alerts_ibfk_3` FOREIGN KEY (`activity_id`) REFERENCES `activities` (`id`) ON DELETE CASCADE;

--
-- Limiti per la tabella `budget_travel_subsistence`
--
ALTER TABLE `budget_travel_subsistence`
  ADD CONSTRAINT `fk_travel_wp_budget` FOREIGN KEY (`wp_partner_budget_id`) REFERENCES `work_package_partner_budgets` (`id`) ON DELETE CASCADE;

--
-- Limiti per la tabella `milestones`
--
ALTER TABLE `milestones`
  ADD CONSTRAINT `milestones_ibfk_1` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `milestones_ibfk_2` FOREIGN KEY (`work_package_id`) REFERENCES `work_packages` (`id`);

--
-- Limiti per la tabella `participant_categories`
--
ALTER TABLE `participant_categories`
  ADD CONSTRAINT `participant_categories_ibfk_1` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE;

--
-- Limiti per la tabella `projects`
--
ALTER TABLE `projects`
  ADD CONSTRAINT `projects_ibfk_1` FOREIGN KEY (`coordinator_id`) REFERENCES `users` (`id`);

--
-- Limiti per la tabella `project_partners`
--
ALTER TABLE `project_partners`
  ADD CONSTRAINT `project_partners_ibfk_1` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `project_partners_ibfk_2` FOREIGN KEY (`partner_id`) REFERENCES `partners` (`id`) ON DELETE CASCADE;

--
-- Limiti per la tabella `project_partners_old`
--
ALTER TABLE `project_partners_old`
  ADD CONSTRAINT `fk_project_partner_link` FOREIGN KEY (`partner_id`) REFERENCES `partners` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `project_partners_old_ibfk_1` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE;

--
-- Limiti per la tabella `project_risks`
--
ALTER TABLE `project_risks`
  ADD CONSTRAINT `project_risks_ibfk_1` FOREIGN KEY (`risk_id`) REFERENCES `risks` (`id`) ON DELETE CASCADE;

--
-- Limiti per la tabella `risk_alerts`
--
ALTER TABLE `risk_alerts`
  ADD CONSTRAINT `risk_alerts_ibfk_1` FOREIGN KEY (`project_risk_id`) REFERENCES `project_risks` (`id`) ON DELETE CASCADE;

--
-- Limiti per la tabella `risk_history`
--
ALTER TABLE `risk_history`
  ADD CONSTRAINT `risk_history_ibfk_1` FOREIGN KEY (`project_risk_id`) REFERENCES `project_risks` (`id`) ON DELETE CASCADE;

--
-- Limiti per la tabella `uploaded_files`
--
ALTER TABLE `uploaded_files`
  ADD CONSTRAINT `fk_uploaded_file_project` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `uploaded_files_ibfk_1` FOREIGN KEY (`report_id`) REFERENCES `activity_reports` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `uploaded_files_ibfk_2` FOREIGN KEY (`uploaded_by`) REFERENCES `users` (`id`);

--
-- Limiti per la tabella `users`
--
ALTER TABLE `users`
  ADD CONSTRAINT `fk_user_partner` FOREIGN KEY (`partner_id`) REFERENCES `partners` (`id`) ON DELETE SET NULL;

--
-- Limiti per la tabella `work_packages`
--
ALTER TABLE `work_packages`
  ADD CONSTRAINT `work_packages_ibfk_1` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `work_packages_ibfk_2` FOREIGN KEY (`lead_partner_id`) REFERENCES `partners` (`id`);

--
-- Limiti per la tabella `work_package_partner_budgets`
--
ALTER TABLE `work_package_partner_budgets`
  ADD CONSTRAINT `fk_wpbudget_partner` FOREIGN KEY (`partner_id`) REFERENCES `partners` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_wpbudget_project` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_wpbudget_work_package` FOREIGN KEY (`work_package_id`) REFERENCES `work_packages` (`id`) ON DELETE CASCADE;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
